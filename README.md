# Домашнее задание к занятию «Резервное копирование баз данных» - Михайлов Дмитрий

**Домашнее задание выполните в Google Docs или в md-файле в вашем репозитории GitHub.** 

Для оформления вашего решения в GitHub можете воспользоваться [шаблоном](https://github.com/netology-code/sys-pattern-homework).

Название файла должно содержать номер лекции и фамилию студента. Пример названия: «12.8. Резервное копирование баз данных — Александр Александров».

Перед тем как выслать ссылку, убедитесь, что её содержимое не является приватным, то есть открыто на просмотр всем, у кого есть ссылка. Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Любые вопросы по решению задач задавайте в чате учебной группы.

---

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

*Приведите ответ в свободной форме.*

### Решение 1

_1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день._
Обязательно!, вначале недели, допустим, это будет технологическое окно в 05:00 утра понедельника, когда нагрузки на БД не будет, либо нагрузка на БД будет минимальной, мы будем делать Полное резервное копирование (Full backup). Далее, мы будем делать Дифференциальный бэкап (differential backup) каждый день - такой бэкап позволит нам в случае, когда всё-таки нам понадобится бэкап БД, восстановить данные за предыдущий день в полном объёме. Сначала восстанавливаем Полный бэкап и к Полному бэкапу восстанавливаем Дифференциальный бэкап за нужный нам день недели, например за четверг. И Я ЗА ЭТОТ ВАРИАНТ! Можно конечно делать бэкап БД с помощью Инкрементного бэкапа (Incremental backup) каждый день, но в таком случае для восстановления данных за четверг нам нужно будет сначала восстановить Полный бэкап, а потом восстанавливать Инкрементный бэкап за понедельник, Инкрементный бэкап за вторник, Инкрементный бэкап за среду, а потом уже Инкрементный бэкап за четверг. В таком случае есть опасность того, что если наш Инкрементый бэкап, например за вторник, забэкапился неккорректно, то данные за четверг уже не восстановить.

_1.2. Необходимо восстанавливать данные за час до предполагаемой поломки._
В случае, если наша "Финансовая компания" мелкая компания:
Немного повторюсь, но всё же. Обязательно!, вначале недели, допустим, это будет технологическое окно в 05:00 утра понедельника, когда нагрузки на БД не будет, либо нагрузка на БД будет минимальной, мы будем делать Полное резервное копирование (Full backup). Далее, мы будем делать Дифференциальный бэкап (differential backup) каждый день. Далее будем делать Инкрементный бэкап (Incremental backup) каждый час.

В случае, если наша "Финансовая компания" крупная компания:
Обязательно!, допустим, это будет технологическое окно в 05:00 утра, когда нагрузки на БД не будет, либо нагрузка на БД будет минимальной, мы будем делать Полное резервное копирование (Full backup) каждый день. Далее, мы будем делать Дифференциальный бэкап (differential backup) каждые три часа. Далее будем делать Инкрементный бэкап (Incremental backup) каждый час.

В случае, если наша "Финансовая компания" очень крупная компания:
Обязательно!, допустим, это будет технологическое окно в 05:00 утра, когда нагрузки на БД не будет, либо нагрузка на БД будет минимальной, мы будем делать Полное резервное копирование (Full backup) каждый день. Далее, мы будем делать Дифференциальный бэкап (differential backup) каждый час. Далее будем делать Инкрементный бэкап (Incremental backup) каждые 15 минут.


---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

*Приведите ответ в свободной форме.*


### Решение 2

_2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore)._

Например, БД Заббикса.

Резервирование: pg_dump zabbix > /tmp/zabbix.dump

Восстановление БД:  pg_restore -d zabbix /tmp/zabbix.dump


---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL. 

3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

*Приведите ответ в свободной форме.*

### Решение 3

_3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL._

Например, забэкапить все базы данных, хранящихся в MySQL:
mysqldump --flush-logs --delete-master-logs --single-transaction --all-databases > /tmp/mysqlbackup/



---

Задания, помеченные звёздочкой, — дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.
